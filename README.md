# gSpatial LangGraph Agent

## 개요
자연어로 된 공간 연산 질의를 Neo4j의 Cypher 쿼리로 변환하는 LangGraph 기반 에이전트입니다. 공간 데이터베이스에서 복잡한 공간 연산을 쉽게 수행할 수 있도록 도와줍니다.

## 실행 방법

1. 의존성 설치:
   ```bash
   pip install -r requirements.txt
   ```
2. 환경 변수 설정 (.env 파일 생성):
   ```
   NEO4J_URI=bolt://localhost:7687
   NEO4J_USERNAME=neo4j
   NEO4J_PASSWORD=your_password
   OPENAI_API_KEY=your_openai_api_key
   ```
3. 에이전트 실행:
   ```bash
   python main.py
   ```
   **사용 예시**
   ```
   질문을 입력하세요: 반포3동의 중심점을 구해줘.
   
   ==================================================
   최종 응답:
   ==================================================
   반포3동의 중심점은 경도 127.0039765, 위도 37.5123278 지점에 위치해 있습니다.
   
   --------------------------------------------------
   상세 쿼리 결과 (최대 5개 항목):
   --------------------------------------------------
   1. {'result': 'POINT (127.00397653968966 37.51232775350869)'}
   ==================================================
   ```

## 시스템 구조
### 주요 컴포넌트
1. main.py
   - 사용자 인터페이스 제공
   - 에이전트 실행 및 결과 표시
2. agent/
   - init.py
      : 패키지 초기화
   - state.py
      : 에이전트 상태 관리
   - nodes.py
      : 워크플로우 노드 구현
   - flow.py
      : LangGraph 워크플로우 정의
   - prompts.py
      : 프롬프트 템플릿
### 워크플로우
1. 질문 분류: 입력된 자연어 질문을 분석
2. 엔티티 추출: 질문에서 공간 객체와 매개변수 추출
3. Cypher 쿼리 생성: 분석 결과를 바탕으로 Cypher 쿼리 생성
4. 쿼리 실행: Neo4j에서 쿼리 실행
5. 응답 생성: 결과를 자연어로 변환하여 출력
### 지원하는 공간 연산
1. 위치 기반 쿼리: 특정 위치의 공간 객체 검색
2. 관계 분석: 공간 객체 간의 관계 분석
3. 측정 계산: 면적, 길이, 거리 등 계산
4. 기하 연산: 교차, 포함, 결합 등